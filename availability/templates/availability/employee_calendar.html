{% extends 'base.html' %}
{% block title %}{{ employee.user.get_full_name|default:employee.user.username }} çš„å¯ä¸Šç­è¡Œäº‹æ›†{% endblock %}

{% block content %}
<h2 class="mb-3">
    ğŸ“† {{ employee.user.get_full_name|default:employee.user.username }} çš„å¯ä¸Šç­è¡Œäº‹æ›†
</h2>

<div class="card shadow-sm">
    <div class="card-body">
        <div id="employee-calendar"></div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('employee-calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridWeek',
        locale: 'zh-tw',
        eventContent: function(arg) {
            const title = arg.event.title;
            const start = arg.event.start.toLocaleTimeString([], {
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });
            const end = arg.event.end.toLocaleTimeString([], {
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });

            // åˆ¤æ–·èƒŒæ™¯è‰²æ·±æ·ºï¼ˆæ·±åº• â†’ ç™½å­—ï¼Œäº®åº• â†’ æ·±å­—ï¼‰
            const bg = arg.backgroundColor || arg.event.backgroundColor;
            const isLight = bg && (
                bg.includes("F") || bg.includes("f") || bg.startsWith("#F") || bg.startsWith("#f")
            );

            const textColor = isLight ? "#333" : "white";
            const subColor = isLight ? "#555" : "#f0f0f0";

            return {
                html: `
                    <div style="font-weight:700;font-size:14px;color:${textColor};">
                        ${start} - ${end}
                    </div>
                `
            };
        },
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,dayGridWeek,dayGridDay'
        },
        events: "{% url 'availability:calendar_data' employee.id %}",
        height: 650
    });
    calendar.render();
});
</script>
{% endblock %}
